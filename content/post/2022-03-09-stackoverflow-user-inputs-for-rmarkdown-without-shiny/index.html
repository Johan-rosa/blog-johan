---
title: 'Stackoverflow: User inputs for Rmarkdown without shiny'
author: Johan Rosa
date: '2022-03-09'
slug: []
categories:
  - javascript
  - R
  - tutorial
tags:
  - css
  - javascript
  - R Markdown
  - jQuery
  - plolty.js
subtitle: ''
description: ''
image: ''
---

<script src="{{< blogdown/postref >}}index_files/header-attrs/header-attrs.js"></script>


<p>This was the title of a <a href="https://stackoverflow.com/questions/71353287/user-inputs-for-r-ggplot-or-plotly-without-shiny/71363657#71363657">stackOverflow questinon</a> that I answered. The user needed interactivity without shiny as dependency.</p>
<p>This is something that can be done but you need to know a little of JavaScript or use a very specific package like <a href="https://rstudio.github.io/crosstalk/using.html">{crosstalk}</a>. I do not think there is another way to get it done.</p>
<p>With that in mind I gave him an option, maybe not exactly what he was looking for, but a useful one.</p>
<!-- This is a container for your inputs -->
<div class="input-container">
<div id="x-coordinate" class="section level3 xs">
<h3>X coordinate</h3>
<p><input type='number' value=5 id='x1' class='x'>
<input type='number' value=2.5 id='x2' class='x'>
<input type='number' value=7.5 id='x3' class='x'></p>
</div>
<div id="y-coordinate" class="section level3 ys">
<h3>Y coordinate</h3>
<p><input type='number' value=10 id='y1'>
<input type='number' value=5 id='y2'>
<input type='number' value=2.5 id='y3'></p>
</div>
</div>
<!-- 
I did it using a submit button, I have to read more to make it totally reactive
-->
<p><input type='button' id='plot' value='Update points' class='btn btn-primary'></p>
<!-- The next div is a placeholder for the plot -->
<div id="tester" style="width:600px;height:400px;">

</div>
<!-- You have to include the plolty.js script -->
<script src="https://cdn.plot.ly/plotly-2.9.0.min.js"></script>
<!-- This is the magic, the Js code -->
<script type="text/javascript">

// Get the html element that should contain the plot
plot = document.getElementById('tester');

// Create an object with the default data
let var1 = {
  x: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10],
  y: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10],
  mode: 'markers',
  type: 'scatter',
  name: 'deafault'
}


let layout = {
  xaxis: {
    range: [ 0, 10.5 ]
  },
  yaxis: {
    range: [0, 10.5]
  },
  title:'Testing'
};

let data = [var1]

// Default plot
Plotly.newPlot(plot, data, layout);


// Using jQuery add an event listener on click to de button
// that way when the user click on it the plot will be updated
$('#plot').click(function(){
  let userInputs = {
    x: [$('#x1').val(), $('#x2').val(), $('#x3').val()],
    y: [$('#y1').val(), $('#y2').val(), $('#y3').val()],
    mode: 'markers',
    type: 'scatter',
    name: 'user'
  }
  
  data = [var1, userInputs] 
  
  Plotly.newPlot(plot, data, layout);
})
</script>
<p>As you can see, it works, and the way I make it work is what I am going to share. Here is the step by step process.</p>
<div id="creating-the-user-interface" class="section level2">
<h2>Creating the user interface</h2>
<p>The first step is to create the user interface within the document. For this I used raw html and pandoc syntax. The idea was to let the user input a series of data coordinates to update a plotly visualization.</p>
<pre class="html"><code>&lt;!-- This is a container for your inputs --&gt;

:::{.input-container}

:::{.xs}
### X coordinate
## A collection of numeric inputs
&lt;input type=&#39;number&#39; value=5 id=&#39;x1&#39; class=&#39;x&#39;&gt;
&lt;input type=&#39;number&#39; value=2.5 id=&#39;x2&#39; class=&#39;x&#39;&gt;
&lt;input type=&#39;number&#39; value=7.5 id=&#39;x3&#39; class=&#39;x&#39;&gt;
:::

:::{.ys}
### Y coordinate
&lt;input type=&#39;number&#39; value=10 id=&#39;y1&#39;&gt;
&lt;input type=&#39;number&#39; value=5 id=&#39;y2&#39;&gt;
&lt;input type=&#39;number&#39; value=2.5 id=&#39;y3&#39;&gt;
:::

::
  
&lt;!-- I used a submit button, I do not know how to make it totally reactive --&gt;
&lt;input type=&#39;button&#39; id=&#39;plot&#39; value=&#39;Update points&#39; class=&#39;btn btn-primary&#39;&gt;
  </code></pre>
<div id="style" class="section level3">
<h3>Style</h3>
<p>The styling part was simple, I just wanted to create a side by side layout for the inputs with a submit button at the bottom.</p>
<pre class="css"><code>input {
  display: block;
}

.xs, .ys {
  display: inline-block;
}</code></pre>
<style type="text/css">
input {
  display: block;
}

.xs, .ys {
  display: inline-block;
}
</style>
</div>
<div id="inlcuding-a-placeholder-for-the-plot" class="section level3">
<h3>Inlcuding a placeholder for the plot</h3>
<p>This can be an empty div just with an id or another identification attribute.</p>
<pre class="html"><code>&lt;!-- The next div is a placeholder for the plot --&gt;
&lt;div id=&quot;tester&quot; style=&quot;width:600px; height:400px;&quot;&gt;&lt;/div&gt;</code></pre>
</div>
</div>
<div id="adding-dependecies" class="section level2">
<h2>Adding dependecies</h2>
<p>At this point it is important to include the dependencies that the javascript code needs. Plolty.js in this particular case.</p>
<pre class="html"><code>&lt;!-- You have to include the plolty.js script --&gt;
&lt;script src=&quot;https://cdn.plot.ly/plotly-2.9.0.min.js&quot;&gt;&lt;/script&gt;</code></pre>
</div>
<div id="create-the-javascript-logic" class="section level2">
<h2>Create the JavaScript logic</h2>
<p>This is definitely the fun part of the question, how can we use the inputs in the user interface to update the plot.</p>
<p>The details of every objet is going to be within the code as commets, here are the overall description of the process.</p>
<p>1- Get the htlm element that should contain the plot</p>
<p>2- Create an object with the default data to plot</p>
<p>3- Create an object with the layout configuration</p>
<p>4- Create an array with the default data</p>
<p>5- Create the default plot using the <code>Plolty.newPlot()</code> method, which takes the data and layout as parameters</p>
<p>6- Use jQuery to add an event listener to the button. The callback function will do as follows</p>
<ul>
<li>Create a new data object with the inputs values</li>
<li>Append this new object to de data array</li>
<li>Generate the plot again</li>
</ul>
<pre class="js"><code>
// 1- Get the html element that should contain the plot
plot = document.getElementById(&#39;tester&#39;);

// 2- Create an object with the default data
let var1 = {
  x: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10],
  y: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10],
  mode: &#39;markers&#39;,
  type: &#39;scatter&#39;,
  name: &#39;deafault&#39;
}

// 3- Layout configuration
let layout = {
  xaxis: {
    range: [ 0, 10.5 ]
  },
  yaxis: {
    range: [0, 10.5]
  },
  title:&#39;Testing&#39;
};

// 4- data array
let data = [var1]

// 5- Default plot
Plotly.newPlot(plot, data, layout);

// Using jQuery add an event listener on click to de button
// that way when the user click on it the plot will be updated
$(&#39;#plot&#39;).click(function(){
  let userInputs = {
    x: [$(&#39;#x1&#39;).val(), $(&#39;#x2&#39;).val(), $(&#39;#x3&#39;).val()],
    y: [$(&#39;#y1&#39;).val(), $(&#39;#y2&#39;).val(), $(&#39;#y3&#39;).val()],
    mode: &#39;markers&#39;,
    type: &#39;scatter&#39;,
    name: &#39;user&#39;
  }
  
  data = [var1, userInputs] 
  
  Plotly.newPlot(plot, data, layout);
})</code></pre>
</div>
<div id="references" class="section level2">
<h2>References</h2>
<ul>
<li><a href="https://plotly.com/javascript/line-and-scatter/">Plolty.js docs</a></li>
<li><a href="https://www.manning.com/books/jquery-in-action-third-edition">jQuery in action, book</a></li>
</ul>
</div>
