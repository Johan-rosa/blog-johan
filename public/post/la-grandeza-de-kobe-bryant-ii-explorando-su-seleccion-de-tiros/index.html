<!DOCTYPE html>
<html lang="en-us">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    
    <meta property="og:site_name" content="Johan Rosa">
    <meta property="og:type" content="article">

    
    <meta property="og:image" content="//img/home_wave.jpg">
    <meta property="twitter:image" content="//img/home_wave.jpg" />
    

    
    <meta name="title" content="La grandeza de Kobe Bryant II: explorando su selección de tiros" />
    <meta property="og:title" content="La grandeza de Kobe Bryant II: explorando su selección de tiros" />
    <meta property="twitter:title" content="La grandeza de Kobe Bryant II: explorando su selección de tiros" />
    

    
    <meta name="description" content="Un Blog personal con contenido de Ciencia de los datos">
    <meta property="og:description" content="Un Blog personal con contenido de Ciencia de los datos" />
    <meta property="twitter:description" content="Un Blog personal con contenido de Ciencia de los datos" />
    

    
    <meta property="twitter:card" content="summary" />
    
    

    <meta name="keyword"  content="Johan Rosa, Rstats, R, Ciencia de datos, data science, dataviz">
    <link rel="shortcut icon" href="/img/favicon.ico">

    <title>La grandeza de Kobe Bryant II: explorando su selección de tiros-Blog de Johan</title>

    <link rel="canonical" href="/post/la-grandeza-de-kobe-bryant-ii-explorando-su-seleccion-de-tiros/">

    <link rel="stylesheet" href="/css/iDisqus.min.css"/>
	
    
    <link rel="stylesheet" href="/css/bootstrap.min.css">

    
    <link rel="stylesheet" href="/css/hux-blog.min.css">

    
    <link rel="stylesheet" href="/css/syntax.css">
    
    
    <link rel="stylesheet" href="/css/zanshang.css">
    
    
    <link href="//cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" type="text/css">

    
    

    
    
    <script src="/js/jquery.min.js"></script>
    
    
    <script src="/js/bootstrap.min.js"></script>
    
    
    <script src="/js/hux-blog.min.js"></script>

    
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.13.1/styles/docco.min.css">
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.13.1/highlight.min.js"></script>
    <script>hljs.initHighlightingOnLoad();</script>

    
    

</head>



<nav class="navbar navbar-default navbar-custom navbar-fixed-top">
    <div class="container-fluid">
        
        <div class="navbar-header page-scroll">
            <button type="button" class="navbar-toggle">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="/">Johan Rosa</a>
        </div>

        
        
        <div id="huxblog_navbar">
            <div class="navbar-collapse">
                <ul class="nav navbar-nav navbar-right">
                    <li>
                        <a href="/">Home</a>
                    </li>
                    
                    
		    
                        <li><a href="/top/about/">Quién soy</a></li>
                    
                        <li><a href="/top/cv/">CV</a></li>
                    

                    
                </ul>
            </div>
        </div>
        
    </div>
    
</nav>
<script>
    
    
    
    var $body   = document.body;
    var $toggle = document.querySelector('.navbar-toggle');
    var $navbar = document.querySelector('#huxblog_navbar');
    var $collapse = document.querySelector('.navbar-collapse');

    $toggle.addEventListener('click', handleMagic)
    function handleMagic(e){
        if ($navbar.className.indexOf('in') > 0) {
        
            $navbar.className = " ";
            
            setTimeout(function(){
                
                if($navbar.className.indexOf('in') < 0) {
                    $collapse.style.height = "0px"
                }
            },400)
        }else{
        
            $collapse.style.height = "auto"
            $navbar.className += " in";
        }
    }
</script>




<style type="text/css">
    header.intro-header {
        background-image: url('/img/banner/kobe_dunk.jpg')
    }
</style>
<header class="intro-header">
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <div class="post-heading">
                    <div class="tags">
                        
                        <a class="tag" href="/tags/ggplot2" title="ggplot2">
                            ggplot2
                        </a>
                        
                        <a class="tag" href="/tags/tidyverse" title="tidyverse">
                            tidyverse
                        </a>
                        
                    </div>
                    <h1>La grandeza de Kobe Bryant II: explorando su selección de tiros</h1>
                    <h2 class="subheading"></h2>
                    <span class="meta">
                        Publicado por 
                        
                            Johan Rosa
                         
                        el  
                        2020-03-24
                        
                        
                        
                    </span>
                </div>
            </div>
        </div>
    </div>
</header>




<article>
    <div class="container">
        <div class="row">

            
            <div class="
                col-lg-11 col-lg-offset-1
                col-md-10 col-md-offset-1
                post-container">

                
                
<script src="/rmarkdown-libs/htmlwidgets/htmlwidgets.js"></script>
<script src="/rmarkdown-libs/plotly-binding/plotly.js"></script>
<script src="/rmarkdown-libs/typedarray/typedarray.min.js"></script>
<script src="/rmarkdown-libs/jquery/jquery.min.js"></script>
<link href="/rmarkdown-libs/crosstalk/css/crosstalk.css" rel="stylesheet" />
<script src="/rmarkdown-libs/crosstalk/js/crosstalk.min.js"></script>
<link href="/rmarkdown-libs/plotly-htmlwidgets-css/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="/rmarkdown-libs/plotly-main/plotly-latest.min.js"></script>


<p>Tras el fallecimiento de Kobe Bryant me comprometí a postear una serie de entradas relacionadas a él. En esta oportunidad haremos un análisis exploratorio de Kobe Bryant desde la óptica de los tiros que tomó en sus 20 años de carrera profesional.</p>
<p>La data que utilizaremos para este análisis tiene la ubicación de cada tiro tomado por Kobe, resultando muy interesante y tentadora para hacer valoraciones y críticas, pero la verdad es que tiene limitaciones para comprender lo legendario de cada tiro tomado por Kobe Bryant.</p>
<p>Las limitaciones que tiene los registros de tiro para hacer valoraciones profundas sobre la selección de tiro de un jugador son muchas, así que voy a resaltar algunas para justificar las razones por las que no haré valoraciones, además de mi condición de fanático e inexperto.</p>
<p>Limitaciones:</p>
<ul>
<li>No hay detalles de la defensa. No sabemos a qué distancia estaba el defensor más cercano, cuantos defensores había, quienes estaba defendiendo (Hay defensores más hábiles que otros)</li>
<li>No hay detalles que los malabares que hizo para llegar a determinada posición.</li>
<li>Esta data puede conducir a interpretaciones burdas, alguien podría concluir que como debajo del aro la eficiencia de tiro de un jugador es mayor, pues debería tomar más tiros de esa zona, cuando en realidad llegar a esa zona es bastante complicado y quizás incremente mucho la posibilidad de pérdidas de balón.</li>
<li>No hay detalles de la posición de los compañeros en la cancha, ni de quienes eran. No podemos decir si había una opción de tiro mejor (Difícil que haya una opción mejor a que Kobe la tire).</li>
</ul>
<p>Por estas razones me limitaré a ser completamente descriptivo en este post, además de equilibrar adecuadamente la interpretación de las visualizaciones y los comentarios sobre los detalles y estrategias utilizadas para generarlas. Esto para no aburrir a los que entren a leer sin interés muy profundo en el código, o viceversa.</p>
<div id="para-reproducir-el-contenido" class="section level2">
<h2>Para reproducir el contenido</h2>
<p>Como de costumbre, compartiré el enlace al repositorio de la publicación en github, pero esta vez y quizás en las próximas ocasiones, compartiré también el enlace del proyecto en rstudio.cloud. Esta segunda opción garantiza la reproducción de todo el contenido, al poner una sección de R en el navegador, con todos los paquetes y archivos utilizados para crear el material.</p>
<ul>
<li><a href="https://rstudio.cloud/project/1010634">Proyecto en rstudio.cloud</a></li>
<li><a href="https://github.com/Johan-rosa/kobe_shot_selection">Repositorio en github</a></li>
</ul>
<p>Por otro lado, con el fin de lograr visualizaciones llamativas intenté varias opciones para incorporar los segmentos de la cancha en los gráficos. El primer intento fue colocar una imagen de fondo en los gráficos, pero no lograba ajustar bien las dimensiones y quedaba feo. El segundo intento consistió dibujar las líneas con ggplot2. Para lograr esto me auxilié del código de varias personas, principalmente el de <a href="https://toddwschneider.com/">Todd Wschneider</a> que a su vez se basó en las publicaciones de <a href="http://savvastjortjoglou.com/nba-shot-sharts.html">Savvas Tjortjoglou</a> (por eso amo mundo open source). Menciono esto porque las adaptaciones que le hice a lo que ellos hicieron fueron extensas y por sí solas representarían una publicación individual, pero igual pueden acceder a todos los objetos desde el workspace en los repositorios.</p>
</div>
<div id="la-data" class="section level2">
<h2>La data</h2>
<p>La data para este análisis es una publicada en <a href="https://www.kaggle.com/">kaggle</a> para una competencia de machine learning. El objetivo de la competencia es utilizar un set de los tiros tomados por Kobe y construir un modelo que clasifique si una serie de observaciones, para las cuales no tenemos el resultado, fueron encestados o no.</p>
<p>Entre las variables que constituyen el set de datos se encuentran las siguientes:</p>
<ul>
<li>Ubicación del tiro, con coordenadas en escala a las dimensiones de una chancha de basket.</li>
<li>Zona del tiro</li>
<li>Distancia respecto al aro</li>
<li>Tiempo restante del cuarto</li>
<li>Tipo de tiro (tablerito, gancho, donqueo, jump shot)</li>
<li>Id del juego</li>
<li>Equipo contrincante</li>
<li>Si el tiro se tomó en playoff o serie regular</li>
<li>Fecha del juego</li>
<li>Resultado del lanzamiento (acierto o fallo)</li>
</ul>
<p>Aquí el <a href="https://www.kaggle.com/c/kobe-bryant-shot-selection">enlace de la competencia</a> con los detalles sobre el set de datos, el enlace original de descarga y algunos notebooks de gente que ha compartido sus análisis y modelos. Es probable que en unos días yo publique el mío también.</p>
</div>
<div id="manos-a-la-obra" class="section level2">
<h2>Manos a la obra</h2>
<pre class="r"><code># Paquetes
library(tidyverse)
library(ggthemes)
library(patchwork)
library(tidytext) # para usar reorder_within() y scale_y_reordered()

# Función para crear los segmentos de la chancha
# Esta función fue creada en base al trabajo de Todd Wschneider
source(&quot;scripts/court_plot.R&quot;)

# Importando la data 
shots_data &lt;- read_csv(&quot;data.csv&quot;) %&gt;% 
  # Unas simples transformaciones a las coordenadas de los tiros
  # para que sean congruente con la escla de court_points
  mutate(
    loc_x = loc_x/10,
    loc_y = (loc_y + 50)/10
  )

# Puntos de la cancha
court_points &lt;- generate_court_points()</code></pre>
<p>La verdad es que kobe tiraba mucho, tomaba tiros muy difíciles con mucha frecuencia y eso lo llevó a marcar un porcentaje de aciertos cuestionable para algunos. En toda su carrea lanzó cerca de 45% de campo, pero aun así se colocó en el top tres de anotadores de la historia de la NBA (Lebron le pasó días antes de su muerte), también deleitó al mundo con una serie de canastos inigualables.</p>
<p>En general y sin considerar los tiros libres, kobe tomó 30,697 tiros de campo, de los cuales 24,271 fueron intentos de dos puntos (79.1%) y 6,426 fueron intentos detrás de la línea de tres.</p>
<pre class="r"><code>shots_data %&gt;% 
  count(shot_type) %&gt;% 
  janitor::adorn_totals(&quot;row&quot;)</code></pre>
<pre><code>##       shot_type     n
##  2PT Field Goal 24271
##  3PT Field Goal  6426
##           Total 30697</code></pre>
<p>El primer gráfico muestra la distribución de estos tiros en las diferentes temporadas. Kobe tomó más de 1,000 tiros en la mayoría de las temporadas que jugó y solo tomó menos de 750 tiros en los años de novato y en los años tras la lesión del tendón de Aquiles.</p>
<pre class="r"><code># Gráfico de la cantidad de tiros
p1 &lt;- shots_data %&gt;%
  group_by(season = parse_number(season), shot_type) %&gt;% 
  summarise(fg_percent = mean(shot_made_flag, na.rm = TRUE),
            tiros = n()) %&gt;% 
  ggplot(aes(x = season, y = tiros, color = shot_type)) +
  geom_line() +
  geom_point() +
  scale_y_continuous(labels = scales::comma) +
  theme_light() +
  scale_color_tableau() +
  theme(
    legend.position = &quot;none&quot;,
    axis.text.x = element_blank(),
    axis.title.x = element_blank()
  ) +
  labs(
    x = &quot;&quot;,
    y = &quot;Tiros&quot;,
    title = &quot;Cantidad de tiros y porcentaje de aciertos por temporada&quot;
  )

# Gráfico del porcentaje de campo
p2 &lt;- shots_data %&gt;%
  group_by(season = parse_number(season), shot_type) %&gt;% 
  summarise(
    fg_percent = mean(shot_made_flag, na.rm = TRUE),
    tiros = n()
    ) %&gt;% 
  ggplot(aes(x = season, y = fg_percent, color = shot_type)) +
  geom_line() +
  geom_point() +
  scale_y_continuous(labels = scales::percent) +
  coord_cartesian(ylim = c(0, 0.60)) +
  theme_light() +
  scale_color_tableau() +
  theme(
    legend.position = &quot;bottom&quot;
  ) +
  labs(x = &quot;Temporada&quot;, y = &quot;Porcentaje&quot;)
  
p1 / p2</code></pre>
<p><img src="/post/2020-03-24-la-grandeza-de-kobe-bryant-ii-explorando-su-seleccion-de-tiros_files/figure-html/eficiencia_temporada-1.png" width="672" /></p>
<p>Las siguientes visualizaciones exploran los tiros tomados por Kobe, pero enfocándose en la posición de la cancha en la que los tomó. Indudablemente el lugar del tiro influye mucho en la probabilidad de acierto, muchas veces los tiros más alejados suelen fallarse más, o los del lado opuesto a la mano dominante, etc. El set de datos trae 2 variables categóricas con la posición de la cancha en la que se tomó el tiro, por tanto, podemos ver la cantidad y el porcentaje de acierto en cada zona.</p>
<p>Estos gráficos introducen dos cuestiones novedosas:</p>
<ol style="list-style-type: decimal">
<li><p>Usan la función <code>reorder_within()</code> del paquete <code>{tidytext}</code>, creado por Julia Silge y David Robinson, que permite tener gráficos en facets con ejes organizados independientemente.</p></li>
<li><p>Usar todo un gráfico como anotación en otro gráfico. Esto puede tener una gran variedad de usos, pero en este caso se utiliza para colocar una leyenda interesante al gráfico. De esta forma hasta alguien poco familiarizado con las dimensiones de una chancha entendería a qué área se refiere cada barra.</p></li>
</ol>
<pre class="r"><code># Gráfico que funguirá como leyenda
shot_zone2 &lt;- shots_data %&gt;% 
  # excluyendo los tiros antes de cruzar la media chancha
  filter(shot_zone_area != &quot;Back Court(BC)&quot;) %&gt;% 
  ggplot() +
  geom_point(aes(
    x = loc_x, y = loc_y,
    color = shot_zone_area), show.legend = FALSE) +
  # Agregando las líneas de la chancha
   geom_path(
    data = court_points,
    aes(x = x, y = y, group = desc)
  ) +
  # Tema sin elementos visuales
  theme_void() +
  # Mover la leyenda
  theme(legend.position = &quot;right&quot;) +
  # una escala de color bonita
  scale_color_tableau()

# Gráfico de barras con los tiros y porcentaje de tiro por zona
shots_data %&gt;% 
  filter(shot_zone_area != &quot;Back Court(BC)&quot;) %&gt;% 
  group_by(shot_zone_area) %&gt;% 
  summarise(
    tiros = n(),
    porcentaje = mean(shot_made_flag, na.rm = TRUE)
  ) %&gt;% 
  # colocando la data en formato largo
  # en el futuro usen pivote_longer
  gather(medida, valor, -shot_zone_area) %&gt;%
  mutate(
    medida = factor(medida, labels = c(&quot;Porcentaje de tiro&quot;, &quot;Cantidad de tiros&quot;))
  ) %&gt;% 
  ggplot(aes(
    # Creando el factor organizado individualmenet
    x = tidytext::reorder_within(shot_zone_area, by = desc(valor), within = medida),
    y = valor,
    fill = shot_zone_area)
    ) +
  geom_col(show.legend = FALSE, alpha = 0.8) +
  facet_wrap(~medida, scales = &quot;free&quot;) +
  tidytext::scale_x_reordered() +
  coord_flip() +
  # Agregando el gráfico anterior como anotación
  annotation_custom(ggplotGrob(shot_zone2), xmin = 3.8, xmax = 5.5, ymin = 6500, ymax = 12000) +
  theme_minimal() +
  scale_y_continuous(labels = function(x) format(x, big.mark = &quot;,&quot;, digits = 2)) +
  theme(
    strip.text = element_text(size = 12, face = &quot;bold&quot;)
  ) +
  labs(x = &quot;&quot;,
       y = &quot;&quot;,
       title = &quot;Tiros tomados y eficiencia en diferentes zonas de la cancha&quot;) +
   scale_fill_tableau()</code></pre>
<p><img src="/post/2020-03-24-la-grandeza-de-kobe-bryant-ii-explorando-su-seleccion-de-tiros_files/figure-html/desempeno_area2-1.png" width="960" /></p>
<pre class="r"><code>shot_zone &lt;- shots_data %&gt;% 
  filter(shot_zone_basic != &quot;Backcourt&quot;) %&gt;% 
  ggplot() +
  geom_point(
    aes(x = loc_x, y = loc_y,
        color = shot_zone_basic), show.legend = FALSE
    ) +
   geom_path(
    data = court_points,
    aes(x = x, y = y, group = desc)
  ) +
  theme(
    axis.text = 
  ) +
  theme_void() +
  theme(legend.position = &quot;right&quot;) +
  labs() +
   scale_color_tableau()


shots_data %&gt;% 
  filter(shot_zone_basic != &quot;Backcourt&quot;) %&gt;% 
  group_by(shot_zone_basic) %&gt;% 
  summarise(
    tiros = n(),
    porcentaje = mean(shot_made_flag, na.rm = TRUE)
  ) %&gt;% 
  gather(medida, valor, -shot_zone_basic) %&gt;%
  mutate(
    medida = factor(medida, labels = c(&quot;Porcentaje de tiro&quot;, &quot;Cantidad de tiros&quot;))
  ) %&gt;% 
  ggplot(aes(
    x = tidytext::reorder_within(shot_zone_basic, desc(valor), medida),
    y = valor,
    fill = shot_zone_basic)) +
  geom_col(show.legend = FALSE, alpha = 0.8) +
  facet_wrap(~medida, scales = &quot;free&quot;) +
  tidytext::scale_x_reordered() +
  coord_flip() +
  annotation_custom(
    ggplotGrob(shot_zone),
    xmin = 4, xmax = 6,
    ymin = 6500, ymax = 12000
    ) +
  theme_minimal() +
  scale_y_continuous(labels = function(x) format(x, big.mark = &quot;,&quot;, digits = 2)) +
  theme(
    strip.text = element_text(size = 12, face = &quot;bold&quot;)
  ) +
  labs(x = &quot;&quot;,
       y = &quot;&quot;,
       title = &quot;Tiros tomados y eficiencia en diferentes zonas de la cancha&quot;) +
   scale_fill_tableau()</code></pre>
<p><img src="/post/2020-03-24-la-grandeza-de-kobe-bryant-ii-explorando-su-seleccion-de-tiros_files/figure-html/desempeno_area1-1.png" width="960" /></p>
<p>Sin duda la data categórica es interesante, pero resulta más emocionante ver un gráfico de los tiros individuales. Igual, al estar hablando de más de 30,000 puntos, un poco de <em>overlapping</em> no debería sorprender. Hay que buscar estrategias para lidear con esto, porque en general el gráfico de puntos no deja ver mucho sobre las zonas en las que kobe era más efectivo o, simplemente, tiraba más.</p>
<pre class="r"><code>shots_data %&gt;% 
  filter(shot_zone_basic != &quot;Backcourt&quot;) %&gt;% 
  ggplot(aes(x = loc_x, y = loc_y )) +
  geom_point(alpha = 0.5, aes(color = factor(shot_made_flag))) +
  geom_path(
    data = court_points,
    aes(x = x, y = y, group = desc)
  ) +
  scale_color_tableau(labels = c(&quot;Fallados&quot;, &quot;Acertados&quot;)) +
  theme(
    axis.text = element_blank(),
    axis.title = element_blank(),
    panel.grid = element_blank(),
    axis.ticks = element_blank(),
    panel.background = element_blank(),
    legend.position = &quot;bottom&quot;
  ) + 
  labs(color = &quot;&quot;) +
  coord_cartesian(expand = FALSE) +
  ggtitle(&quot;Distribución de los tiros de Kobe&quot;)</code></pre>
<p><img src="/post/2020-03-24-la-grandeza-de-kobe-bryant-ii-explorando-su-seleccion-de-tiros_files/figure-html/points_shots-1.png" width="672" /></p>
<p>Hay distintas estrategias para lidiar con el <em>overlapping</em>. Entre las más comunes está diminuir la transparencia de los puntos y esperar que las zonas de mayor concentración queden con un color más oscuro. Por otro lado se puede utilizar una geometría especial como <code>hexbin::geom_hex()</code> que crea una especie de histograma bidimensional, en el que divide el espacio en binds hexagonales y cada uno toma color en función a la cantidad de puntos que cae en ellos.</p>
<p>Las geometrías de densidad bidimensional son otra opción para lidiar con este “problema”. Estas facilitan mucho la interpretación porque agrupan las observaciones, en “círculos” con similar cantidad de puntos, de modo los círculos más pequeños tienen mayor densidad. También son una forma de representar en dos dimensiones algo que podría verse en tres.</p>
<p>Aquí se muestran tanto la versión en 2d como la versión 3d. Ahora es más fácil ver de dónde metía y fallaba más Kobe.</p>
<p>Para más ejemplos de cómo lidiar con <em>overlapping</em> pueden consultar las siguientes fuentes: <a href="https://www.data-to-viz.com/caveat/overplotting.html">from data to viz</a> y [R graph gallery], ambas creaciones de <a href="https://github.com/holtzy">Yan Holtz</a>.</p>
<pre class="r"><code>shots_data %&gt;%
  filter(!is.na(shot_made_flag)) %&gt;% 
  filter(combined_shot_type == &quot;Jump Shot&quot;, shot_zone_basic != &quot;Backcourt&quot;) %&gt;% 
  mutate(shot_made_flag = factor(shot_made_flag, labels = c(&quot;Fallados&quot;, &quot;Anotados&quot;))) %&gt;% 
  ggplot() +
        stat_density2d(
          geom = &#39;polygon&#39;,
          contour = T,
          n = 100,
          aes(x = loc_x,
              y = loc_y,
              color = shot_made_flag,
              fill = ..level../max(..level..),
              alpha = ..level..)
          ) +
  geom_path(
    data = court_points,
    aes(x = x, y = y, group = desc)
  ) +
  guides(alpha = FALSE, color = FALSE) +
  facet_wrap(~shot_made_flag) +
  theme(
    axis.text = element_blank(),
    axis.title = element_blank(),
    panel.grid = element_blank(),
    axis.ticks = element_blank(),
    panel.background = element_blank(),
    strip.text = element_text(size = 12),
    legend.position = &quot;bottom&quot;
  ) + 
  labs(title = &quot;Densidad de la distribución de los tiros&quot;) +
  scale_fill_viridis_c(
    option = &quot;magma&quot;
    )</code></pre>
<p><img src="/post/2020-03-24-la-grandeza-de-kobe-bryant-ii-explorando-su-seleccion-de-tiros_files/figure-html/desnity_2d-1.png" width="672" /></p>
<p>Grafíco 3D de la distribución de tiros.</p>
<pre class="r"><code>kd_shots &lt;- with(
  subset(shots_data, action_type == &quot;Jump Shot&quot; &amp; shot_made_flag == 1),
  MASS::kde2d(loc_x, loc_y, n = 30)
  )

plotly::plot_ly(x = kd_shots$x, y = kd_shots$y, z = kd_shots$z) %&gt;% plotly::add_surface()</code></pre>
<div id="htmlwidget-1" style="width:672px;height:480px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-1">{"x":{"visdat":{"175834902c93":["function () ","plotlyVisDat"]},"cur_data":"175834902c93","attrs":{"175834902c93":{"x":[-24.5,-22.8,-21.1,-19.4,-17.7,-16,-14.3,-12.6,-10.9,-9.2,-7.5,-5.8,-4.1,-2.4,-0.699999999999999,1,2.7,4.4,6.1,7.8,9.5,11.2,12.9,14.6,16.3,18,19.7,21.4,23.1,24.8],"y":[1.2,2.82068965517241,4.44137931034483,6.06206896551724,7.68275862068965,9.30344827586207,10.9241379310345,12.5448275862069,14.1655172413793,15.7862068965517,17.4068965517241,19.0275862068966,20.648275862069,22.2689655172414,23.8896551724138,25.5103448275862,27.1310344827586,28.751724137931,30.3724137931034,31.9931034482759,33.6137931034483,35.2344827586207,36.8551724137931,38.4758620689655,40.0965517241379,41.7172413793103,43.3379310344828,44.9586206896552,46.5793103448276,48.2],"z":[[5.09841996708734e-005,0.000166199189059111,0.000312988576287788,0.000345767755997954,0.000258124751489045,0.000191563905043208,0.000181407603312722,0.000153092731654369,0.000140535172168218,0.000166953326167678,0.000198730730316051,0.000200777680119884,0.000160442318944259,0.000106686095043698,6.50246653890899e-005,3.36863777465554e-005,1.24548556378037e-005,2.83622412406756e-006,4.45669846795863e-007,4.69278253365472e-008,2.2392705963418e-009,1.2710542040849e-010,1.43310932544334e-009,7.27771424722753e-009,1.13729337162583e-008,5.4679692699173e-009,8.08826905181074e-010,3.68095979220866e-011,5.1539774665868e-013,2.22023995682606e-015],[7.15921063760132e-005,0.000229932369443278,0.000428536634659028,0.000480400928131285,0.000374724005557436,0.000288685481676486,0.000279666672569057,0.000256970571240408,0.000245502120705396,0.00028636633532202,0.000359136150913031,0.000406022389571579,0.00037927854674684,0.000303665026597966,0.000214939205016394,0.000122066661153243,4.92051636321001e-005,1.28844719217573e-005,2.41236442582706e-006,2.80040172764534e-007,1.44742804148494e-008,1.10539687732976e-009,1.32791241022193e-008,6.74339303524689e-008,1.05379361498535e-007,5.06651119579805e-008,7.49442802643656e-009,3.41070348292865e-010,4.77557205626835e-012,2.05722976669215e-014],[8.13226055237457e-005,0.000264199263850437,0.000493005458514732,0.000558780485196667,0.000459145746748281,0.000371264172878379,0.00036668580123548,0.000367188167120408,0.000357939378406995,0.000395835451416238,0.000499793132294807,0.000609972938660489,0.000656120060460182,0.00062987779736668,0.000520000941407668,0.000332784124054952,0.000150528106713589,4.54969230385e-005,9.62022720273432e-006,1.20058176081818e-006,6.96867864314993e-008,6.51359434919529e-009,7.77834018702557e-008,3.9493852253886e-007,6.17167955161812e-007,2.96726192901486e-007,4.38919687426019e-008,1.99751674557325e-009,2.79686710748302e-011,1.20483955511569e-013],[8.8370853082518e-005,0.000298291581155164,0.000562215696994087,0.000636671387281012,0.000541842236347909,0.000456131274896414,0.00045529973034486,0.000481171942630461,0.000478398191318113,0.000513759082062433,0.000622109156735582,0.000751676979010869,0.000869730873973326,0.000969883214999096,0.000941722843577084,0.000699592224071766,0.000362044465205432,0.000124800746340049,2.89676764514041e-005,3.95398600698828e-006,2.72350442863731e-007,2.70199206827869e-008,2.88193325995114e-007,1.4620969995532e-006,2.28467660408953e-006,1.09842307885921e-006,1.62478643524927e-007,7.39436354147619e-009,1.0353374290727e-010,4.46004463796175e-013],[0.000101599681517211,0.000351046185777598,0.000661718957610135,0.000735261297228864,0.000626389121682503,0.000547553485503839,0.000550199618268635,0.000583266938555029,0.000601151528809733,0.000670871872584747,0.000782112572815008,0.000867739618172431,0.000960011813153783,0.00115416014239509,0.00131041162422399,0.00114576453597164,0.000682910715282304,0.000267595366375169,6.93867298025812e-005,1.08847801894314e-005,9.36782674146358e-007,9.05205864720012e-008,6.7796740039664e-007,3.42330295468408e-006,5.3467748525355e-006,2.57024494244962e-006,3.8017214711032e-007,1.73012629235056e-008,2.4224597506588e-010,1.04354987869209e-012],[0.000116439621431717,0.0003961189291387,0.000738023340644447,0.000793464080928424,0.000658386575747322,0.000605876782828474,0.000620343009856564,0.000642471531110073,0.000693712256327834,0.000829577245202753,0.000969567920424819,0.00101358000461821,0.0010011468816771,0.0011543581084556,0.00144930251720652,0.00146531665909093,0.00100804484170483,0.00045904883216698,0.000139993069061416,2.65079537981482e-005,2.93756777301406e-006,3.11162878912153e-007,1.03906060233416e-006,5.09061301393132e-006,7.92130314697368e-006,3.80337441930943e-006,5.62346271085845e-007,2.55884432885586e-008,3.58264158632424e-010,1.54336629990176e-012],[0.000119388386298071,0.000394514014864284,0.000730119545110641,0.00075603812824123,0.000594596877756053,0.000576095694387173,0.000612520696933314,0.00063009677678842,0.00071353178468451,0.000901664362210161,0.00108904131456236,0.00116067235545517,0.00108309195230695,0.00110281228772781,0.00134765083714974,0.00148200502494615,0.00117997756340536,0.000650711637241332,0.000244352221429912,5.68092913731534e-005,8.1589101680933e-006,1.15995595637537e-006,1.21662903798854e-006,4.97083833601116e-006,7.51181137816139e-006,3.57254371758401e-006,5.26518688857116e-007,2.39322128732294e-008,3.34956228924366e-010,1.44841433657138e-012],[0.000103343323568884,0.000338451652411479,0.000638598245211762,0.000648999802958315,0.000473079913991988,0.000464820313655921,0.000514566805661614,0.000544904556671467,0.000647758780214579,0.000844357469538207,0.00107477383246416,0.00123612408049192,0.00118744546888867,0.00109416061111174,0.00114659733217104,0.00123637854941243,0.00113360892246793,0.000782690963298419,0.000364941674266313,0.000102851793547346,1.91530947243917e-005,3.89473410956028e-006,1.82475575011084e-006,3.96183867858025e-006,4.95831499812095e-006,2.19464316564771e-006,3.15250950777084e-007,1.42036483855649e-008,1.98404985706027e-010,1.22136843600443e-012],[7.4412947903109e-005,0.000252482331137009,0.000508560272858931,0.000538772451136805,0.000379220382744999,0.000355085877410662,0.000395207386024251,0.000437508911043188,0.000543517634967645,0.000714804743041384,0.000964598135828766,0.00121353304359359,0.00123393318018649,0.00108993129520043,0.00096609165671072,0.000928952886886589,0.000948724457948253,0.000816375129417645,0.000462019677710442,0.000155504650503686,3.79354558168127e-005,1.03760208778047e-005,4.00982093948961e-006,4.61765612739785e-006,3.44551542329771e-006,1.07660654052276e-006,1.30498822532086e-007,5.50090561486566e-009,8.32909453540666e-011,1.53840489618051e-011],[4.45383942098503e-005,0.000166859468341176,0.000379791656988536,0.000456402793568165,0.00035457252877122,0.000319848194387544,0.000339656017409062,0.000376919026697394,0.000471362590590355,0.00060783754302466,0.00083918298963368,0.00111409511235237,0.0011785491471683,0.00102579864101356,0.000834528974893824,0.000714106646435691,0.000755051530206813,0.000770171633653126,0.000517760714706153,0.000209054260122344,6.57685541299467e-005,2.11579670163044e-005,7.66423012526366e-006,7.18661196547896e-006,3.90107902718552e-006,7.5199534157493e-007,5.55402888537883e-008,1.71306176641997e-009,2.35349952486687e-010,3.89286290826958e-010],[2.24045354923177e-005,0.00010083269876894,0.000272296177855146,0.000393060044977423,0.000376174803917715,0.000364202732990415,0.000373228648579625,0.000390487060100134,0.000459749084172558,0.000558979423485962,0.000732737789152605,0.000961546860367925,0.00103103054651703,0.00089902364535593,0.000740500352691314,0.000613474294117107,0.000623756486317907,0.000706590594880143,0.000564960438857934,0.000275195933942465,0.000101400176393518,3.28388858436818e-005,1.03501032477665e-005,8.59631734479273e-006,4.36385622355339e-006,7.21762158299973e-007,3.86015161243348e-008,1.31464570003547e-009,3.5305635663395e-009,6.35596579300759e-009],[1.0081300196636e-005,5.89306053030367e-005,0.000190632154306538,0.000332054034233378,0.000401075624167468,0.000450414685774657,0.000472231855722011,0.000466433950607057,0.000495455727458416,0.000546855919953275,0.000646401352802967,0.000796650594758461,0.000851398734530976,0.000763038134189727,0.000679525344404864,0.000584761309054858,0.000554941397662767,0.000666346593043841,0.000637551765777407,0.000363987420718133,0.000137820360668288,3.95320032232809e-005,9.83948275657895e-006,6.73453510608011e-006,3.3404666689149e-006,5.39808385168152e-007,2.7398773410032e-008,6.63552049792661e-009,3.63920398049989e-008,6.56058581188291e-008],[4.76261050564018e-006,3.56264838839012e-005,0.000131516896587518,0.000268050070918341,0.000407192045983937,0.000547521155414738,0.000616480731997211,0.000598122603554864,0.000572759956770692,0.000563380084836927,0.000608122172901869,0.000701526544219637,0.000742548112139621,0.00069801182578019,0.000676476192976278,0.000613053143638,0.000540217295957048,0.000660623929719739,0.000738230775478725,0.000468974977029548,0.000169217110025374,4.01814752710749e-005,7.36104064388262e-006,3.45554534229011e-006,1.63642380692546e-006,2.63010452283629e-007,1.52041960500027e-008,4.07159840576059e-008,2.37414860018514e-007,4.28024056000109e-007],[3.10674009973522e-006,2.52152306259736e-005,9.52899431254981e-005,0.000213701333590956,0.000404756389884713,0.000648107523400037,0.000788799740328938,0.000771026357985642,0.000686705749937799,0.000613673882763324,0.000641496756627133,0.000728255532356523,0.000766547017656161,0.00074050137751552,0.000744878172290123,0.000697184481449311,0.000579887072253821,0.000696220127446265,0.000850961534251054,0.00057105980215196,0.000197262940125358,4.11929087350739e-005,6.23223564056868e-006,1.40664101577978e-006,5.19479704684399e-007,8.16118893447559e-008,1.28098036278256e-008,1.67135858872131e-007,9.79028630285364e-007,1.76505110831781e-006],[3.54761876323761e-006,2.51956759078944e-005,8.58373407904056e-005,0.000189959801540481,0.000410517126806249,0.000728996063662584,0.000923071247501504,0.000906904108049545,0.000780048107792405,0.000664064624053986,0.000698729362622624,0.000810592663112479,0.00085760213677819,0.000826145873276425,0.000827125608662639,0.000778867144505907,0.00062806408312114,0.00073307426556158,0.000915798742449189,0.000625646328335715,0.000216982236313924,4.70576105563131e-005,7.98505177499795e-006,1.00614996439833e-006,1.35321502777902e-007,1.68413813036427e-008,2.36558139524488e-008,4.35485663305968e-007,2.55180749240863e-006,4.60055175057898e-006],[5.38776995687664e-006,3.33708333714362e-005,0.000103842248651456,0.000209240696509837,0.000423780012967885,0.000743327788575302,0.000934031359176071,0.000912213911777849,0.000784162305718499,0.000673459381123805,0.000712740783329454,0.000837042605846795,0.000898480317554585,0.000865058597535605,0.000848712524907248,0.000780257591775371,0.000614667172102749,0.000703113665055612,0.000866744601643149,0.00059268165940201,0.000214357581272199,5.28517916170906e-005,1.07127801837422e-005,1.29811839644198e-006,7.37567149248045e-008,3.59407198958342e-009,3.77705121999063e-008,7.17428957994818e-007,4.20401310660534e-006,7.57924738126426e-006],[7.74834889020087e-006,4.73495116243325e-005,0.000147564927924835,0.000273152051941027,0.000449679222600943,0.000695069412419291,0.000829708656904015,0.000803014132049212,0.000721688704183281,0.000663371475378588,0.000698555418499531,0.000809853166000229,0.00088783846475024,0.00087155772336361,0.00082766717819438,0.000716247679800113,0.000552183019874348,0.000627171611889263,0.000747187804187113,0.000505919780668782,0.000191186677251019,5.12778949891059e-005,1.10821287151168e-005,1.36889703310671e-006,6.81046348476384e-008,1.91143861984283e-009,3.92372979304738e-008,7.47063912627066e-007,4.37767735074927e-006,7.89233972548859e-006],[1.05040763977933e-005,6.59193991138746e-005,0.000211357443412012,0.000370441619559661,0.000499589225032128,0.000638727343949193,0.000698798059473933,0.000679553546538465,0.00066665076934774,0.00067731323113564,0.000724966994514223,0.000831999129901173,0.000934410523629059,0.000946614050790152,0.000855913517471926,0.000680220954969706,0.000531589022713997,0.000609659846806983,0.000671992422626476,0.000434946467727412,0.000163403643156311,4.20286526628019e-005,8.29541279651685e-006,9.73312148671884e-007,4.71721929250795e-008,1.2207825479258e-009,2.58215928680705e-008,4.91700816811171e-007,2.88128995428939e-006,5.19456262906987e-006],[1.62149911322548e-005,9.14056118785924e-005,0.000285435812307486,0.000475621691910133,0.000554589630902506,0.000593436303953584,0.000594361411140156,0.000592394547815541,0.000632423004764308,0.000709483199644892,0.000824966624733031,0.000976174604874423,0.00111313456249077,0.00114566009780957,0.000979675673612943,0.000727438671255951,0.000619320083583523,0.000716164100649496,0.00068059379487386,0.000389781555374545,0.000133651702193603,2.94658921735775e-005,4.60801359954981e-006,4.65286692680113e-007,2.22412579926279e-008,7.69730980469791e-010,1.07607608335872e-008,2.04554296535342e-007,1.19865364012518e-006,2.1610047882531e-006],[2.96810878620915e-005,0.000131810689027412,0.000368991982759509,0.000573859144137278,0.000592278756982172,0.000551114506733523,0.000522785662139967,0.000537080201193169,0.000602603846853406,0.000744813990297059,0.000988980146022567,0.0012347402622295,0.00139831143059652,0.0014119144731302,0.00114759729061145,0.000845658600980289,0.000825067467136645,0.000922802617129841,0.000720867908920843,0.000337364775228256,9.68703577395663e-005,1.7331757733667e-005,2.00397242627713e-006,1.70260544661045e-007,1.96590287154929e-008,3.495592854111e-009,3.08216477221357e-009,5.37931665930655e-008,3.15183909165921e-007,5.68232406983486e-007],[5.42416644958135e-005,0.000198635792651157,0.000480920061053087,0.000682472431759638,0.00063345262691288,0.000534411476266249,0.000498792510039863,0.000526571795421863,0.000607111164311782,0.000810754596410673,0.00118969682204954,0.00152523920838546,0.00167394336593754,0.00161113598845563,0.00126853968189279,0.00101231611745009,0.00111356647553891,0.00113415122503739,0.000724443538441668,0.000268414181098335,6.02563995703701e-005,8.35611868076804e-006,7.54294161912318e-007,1.7881332701879e-007,1.15856103971477e-007,2.86647608891141e-008,2.67090527115714e-009,8.99153248950697e-009,5.23842720565955e-008,9.44408306489451e-008],[8.75955843017693e-005,0.000294581128097841,0.000636668537178415,0.000823782948684878,0.000714960205845844,0.00057921069544572,0.000540413784692331,0.000582906557135919,0.000685626387618729,0.000929840761056886,0.00137083320013165,0.00172003509179119,0.00179786327245695,0.00163973926441586,0.00132002628331914,0.00122551319197698,0.00138810540799686,0.00122255570785581,0.000648192822041407,0.000195705008514808,3.4136757845039e-005,3.52393559501e-006,4.95449450426187e-007,7.69760998616462e-007,6.19293262901774e-007,1.54688242732826e-007,1.19397419283672e-008,1.2202980477968e-009,5.50499010268013e-009,9.92104267204964e-009],[0.000121216573571805,0.000399897736991824,0.000812208359088795,0.000986992221588602,0.000841437007801885,0.000684134218661579,0.000630448188852868,0.000685861766606459,0.000814387983503527,0.00105291802911249,0.00144049358084364,0.00171807462792882,0.00171636729205386,0.00153391076301875,0.00137710120839274,0.00145232000096296,0.00150332066858371,0.00110760536689527,0.000494331339961347,0.000127956700138836,1.86939554665507e-005,1.58428524808964e-006,1.04533222666138e-006,2.60403660903845e-006,2.11364031377322e-006,5.2808014509397e-007,4.05959765131083e-008,1.02235698389701e-009,3.7237449752505e-010,6.58761599717071e-010],[0.000145331867409768,0.000479319707326756,0.000946802365173895,0.0011209130833131,0.000966675263568886,0.000789501556958218,0.000701210039861461,0.000756066741814847,0.00089569711987207,0.0010812110397466,0.00133361980174059,0.00151711894253926,0.00151285795016919,0.00143354514823004,0.00147911427228581,0.00156425329080553,0.00135896242488157,0.000827090446651961,0.000315280309754824,7.24278900670332e-005,9.52691493400426e-006,8.94064121392748e-007,2.14767152745873e-006,5.6164990360695e-006,4.56080575115239e-006,1.13949846976785e-006,8.75916542014827e-008,2.07412348230095e-009,3.04074207006751e-011,2.76803804530227e-011],[0.000155561327059321,0.000508164325707302,0.000985996679487523,0.0011599881109886,0.00101306053888878,0.000811775864698546,0.000677863072999796,0.000707312904320728,0.000831618304319903,0.000964090526228757,0.00109930931072085,0.00123763818109338,0.00132687422138748,0.00139439686554829,0.00150046668215824,0.00141272369967914,0.000998390414505635,0.000507580757723423,0.000170790546267066,3.59599268861344e-005,4.34371364984893e-006,6.01120418312902e-007,2.90902998690276e-006,7.65996387540431e-006,6.22041023679836e-006,1.55414435719463e-006,1.19464721305982e-007,2.82536521292089e-009,2.09639966061839e-011,7.7940133200774e-013],[0.000153332580206801,0.000490102816033295,0.000928871685065075,0.00108183176316275,0.000938372085157579,0.00071934828727027,0.000553985924015879,0.000544878733236399,0.000639610219989799,0.000763362980805775,0.000871406498932438,0.00102446471991797,0.00119815985813738,0.00129030474567255,0.0012723729889839,0.00100916788268972,0.00058479789648961,0.000257687865627599,8.10115330931197e-005,1.64365425750663e-005,1.8465038567481e-006,3.87709367998458e-007,2.50390663339501e-006,6.60336055739092e-006,5.36241168680549e-006,1.33977693459056e-006,1.02986619380715e-007,2.43559610804842e-009,1.77285165463983e-011,5.19682635805892e-014],[0.000142076361132391,0.000449427574572836,0.000829489497698965,0.000937254328947003,0.000784393729792786,0.000566573564165567,0.000401111909990828,0.000368876222963231,0.000442831282915816,0.000585373126412389,0.000717182233309955,0.000875054357756461,0.00101603109443977,0.000994769840653095,0.000833384963075715,0.00055085082404981,0.000268751229175967,0.000108301848408852,3.35053328752176e-005,6.73802601210996e-006,7.23255419689739e-007,1.91699048023826e-007,1.36375912053169e-006,3.59806442789051e-006,2.921896427595e-006,7.30024044547439e-007,5.61158402064718e-008,1.32711859912131e-009,9.65635449739907e-012,2.17468528752605e-014],[0.000125393250609173,0.000403196743805507,0.000731124305278493,0.000789828617537149,0.000626331967933325,0.000431252630469068,0.000290358611880284,0.000255267532796137,0.000316438213016316,0.000453773983253966,0.000574021084413466,0.000672428061105738,0.000705004300023035,0.000587554611182944,0.00040716064194129,0.000226021759050456,9.53754255654362e-005,3.68515054287503e-005,1.14302572893033e-005,2.22393447331336e-006,2.28639090623732e-007,6.43190158722417e-008,4.69628156561706e-007,1.23918718537054e-006,1.0063128331243e-006,2.51423205540122e-007,1.93265201764797e-008,4.57064958034288e-010,3.32566276362255e-012,7.44569493523362e-015],[0.000101637603199329,0.000334503606746602,0.000601601579992272,0.000625972237416609,0.000475677692426751,0.000324700008230758,0.000220135770725603,0.000187993205697476,0.000228883059058817,0.000319869490454138,0.000382183948812445,0.000401957691304597,0.000365883963959952,0.000255747212317046,0.000146800133238824,6.95171967155917e-005,2.57312221972304e-005,9.69394524443032e-006,2.99604934436887e-006,5.4045669408358e-007,5.1720944387515e-008,1.3983453110798e-008,1.02229248087121e-007,2.69754424360138e-007,2.19060831715513e-007,5.47314659417846e-008,4.20712471047606e-009,9.94969224329652e-011,7.23952158297068e-013,1.6206417814524e-015],[6.7619888449432e-005,0.000225068079817035,0.000402695818741571,0.000409382901021848,0.000304800039518586,0.000212611067982594,0.000148971263474366,0.00012292538539607,0.000139884361718081,0.000177051219640862,0.000189331059941549,0.000173218058361481,0.000135923265420494,8.04893166350265e-005,3.89679428443837e-005,1.61066338145665e-005,5.21485303129153e-006,1.87099832031552e-006,5.6923400940746e-007,9.27771141644221e-008,7.94689531103297e-009,1.94096913086187e-009,1.40660942681189e-008,3.71162265489361e-008,3.01411612477626e-008,7.53064766357117e-009,5.78869455187335e-010,1.3690045635674e-011,9.96104986495864e-014,2.2298790547609e-016]],"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"surface","inherit":true}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"scene":{"xaxis":{"title":[]},"yaxis":{"title":[]},"zaxis":{"title":[]}},"hovermode":"closest","showlegend":false,"legend":{"yanchor":"top","y":0.5}},"source":"A","config":{"showSendToCloud":false},"data":[{"colorbar":{"title":"","ticklen":2,"len":0.5,"lenmode":"fraction","y":1,"yanchor":"top"},"colorscale":[["0","rgba(68,1,84,1)"],["0.0416666666666667","rgba(70,19,97,1)"],["0.0833333333333333","rgba(72,32,111,1)"],["0.125","rgba(71,45,122,1)"],["0.166666666666667","rgba(68,58,128,1)"],["0.208333333333333","rgba(64,70,135,1)"],["0.25","rgba(60,82,138,1)"],["0.291666666666667","rgba(56,93,140,1)"],["0.333333333333333","rgba(49,104,142,1)"],["0.375","rgba(46,114,142,1)"],["0.416666666666667","rgba(42,123,142,1)"],["0.458333333333333","rgba(38,133,141,1)"],["0.5","rgba(37,144,140,1)"],["0.541666666666667","rgba(33,154,138,1)"],["0.583333333333333","rgba(39,164,133,1)"],["0.625","rgba(47,174,127,1)"],["0.666666666666667","rgba(53,183,121,1)"],["0.708333333333333","rgba(79,191,110,1)"],["0.75","rgba(98,199,98,1)"],["0.791666666666667","rgba(119,207,85,1)"],["0.833333333333333","rgba(147,214,70,1)"],["0.875","rgba(172,220,52,1)"],["0.916666666666667","rgba(199,225,42,1)"],["0.958333333333333","rgba(226,228,40,1)"],["1","rgba(253,231,37,1)"]],"showscale":true,"x":[-24.5,-22.8,-21.1,-19.4,-17.7,-16,-14.3,-12.6,-10.9,-9.2,-7.5,-5.8,-4.1,-2.4,-0.699999999999999,1,2.7,4.4,6.1,7.8,9.5,11.2,12.9,14.6,16.3,18,19.7,21.4,23.1,24.8],"y":[1.2,2.82068965517241,4.44137931034483,6.06206896551724,7.68275862068965,9.30344827586207,10.9241379310345,12.5448275862069,14.1655172413793,15.7862068965517,17.4068965517241,19.0275862068966,20.648275862069,22.2689655172414,23.8896551724138,25.5103448275862,27.1310344827586,28.751724137931,30.3724137931034,31.9931034482759,33.6137931034483,35.2344827586207,36.8551724137931,38.4758620689655,40.0965517241379,41.7172413793103,43.3379310344828,44.9586206896552,46.5793103448276,48.2],"z":[[5.09841996708734e-005,0.000166199189059111,0.000312988576287788,0.000345767755997954,0.000258124751489045,0.000191563905043208,0.000181407603312722,0.000153092731654369,0.000140535172168218,0.000166953326167678,0.000198730730316051,0.000200777680119884,0.000160442318944259,0.000106686095043698,6.50246653890899e-005,3.36863777465554e-005,1.24548556378037e-005,2.83622412406756e-006,4.45669846795863e-007,4.69278253365472e-008,2.2392705963418e-009,1.2710542040849e-010,1.43310932544334e-009,7.27771424722753e-009,1.13729337162583e-008,5.4679692699173e-009,8.08826905181074e-010,3.68095979220866e-011,5.1539774665868e-013,2.22023995682606e-015],[7.15921063760132e-005,0.000229932369443278,0.000428536634659028,0.000480400928131285,0.000374724005557436,0.000288685481676486,0.000279666672569057,0.000256970571240408,0.000245502120705396,0.00028636633532202,0.000359136150913031,0.000406022389571579,0.00037927854674684,0.000303665026597966,0.000214939205016394,0.000122066661153243,4.92051636321001e-005,1.28844719217573e-005,2.41236442582706e-006,2.80040172764534e-007,1.44742804148494e-008,1.10539687732976e-009,1.32791241022193e-008,6.74339303524689e-008,1.05379361498535e-007,5.06651119579805e-008,7.49442802643656e-009,3.41070348292865e-010,4.77557205626835e-012,2.05722976669215e-014],[8.13226055237457e-005,0.000264199263850437,0.000493005458514732,0.000558780485196667,0.000459145746748281,0.000371264172878379,0.00036668580123548,0.000367188167120408,0.000357939378406995,0.000395835451416238,0.000499793132294807,0.000609972938660489,0.000656120060460182,0.00062987779736668,0.000520000941407668,0.000332784124054952,0.000150528106713589,4.54969230385e-005,9.62022720273432e-006,1.20058176081818e-006,6.96867864314993e-008,6.51359434919529e-009,7.77834018702557e-008,3.9493852253886e-007,6.17167955161812e-007,2.96726192901486e-007,4.38919687426019e-008,1.99751674557325e-009,2.79686710748302e-011,1.20483955511569e-013],[8.8370853082518e-005,0.000298291581155164,0.000562215696994087,0.000636671387281012,0.000541842236347909,0.000456131274896414,0.00045529973034486,0.000481171942630461,0.000478398191318113,0.000513759082062433,0.000622109156735582,0.000751676979010869,0.000869730873973326,0.000969883214999096,0.000941722843577084,0.000699592224071766,0.000362044465205432,0.000124800746340049,2.89676764514041e-005,3.95398600698828e-006,2.72350442863731e-007,2.70199206827869e-008,2.88193325995114e-007,1.4620969995532e-006,2.28467660408953e-006,1.09842307885921e-006,1.62478643524927e-007,7.39436354147619e-009,1.0353374290727e-010,4.46004463796175e-013],[0.000101599681517211,0.000351046185777598,0.000661718957610135,0.000735261297228864,0.000626389121682503,0.000547553485503839,0.000550199618268635,0.000583266938555029,0.000601151528809733,0.000670871872584747,0.000782112572815008,0.000867739618172431,0.000960011813153783,0.00115416014239509,0.00131041162422399,0.00114576453597164,0.000682910715282304,0.000267595366375169,6.93867298025812e-005,1.08847801894314e-005,9.36782674146358e-007,9.05205864720012e-008,6.7796740039664e-007,3.42330295468408e-006,5.3467748525355e-006,2.57024494244962e-006,3.8017214711032e-007,1.73012629235056e-008,2.4224597506588e-010,1.04354987869209e-012],[0.000116439621431717,0.0003961189291387,0.000738023340644447,0.000793464080928424,0.000658386575747322,0.000605876782828474,0.000620343009856564,0.000642471531110073,0.000693712256327834,0.000829577245202753,0.000969567920424819,0.00101358000461821,0.0010011468816771,0.0011543581084556,0.00144930251720652,0.00146531665909093,0.00100804484170483,0.00045904883216698,0.000139993069061416,2.65079537981482e-005,2.93756777301406e-006,3.11162878912153e-007,1.03906060233416e-006,5.09061301393132e-006,7.92130314697368e-006,3.80337441930943e-006,5.62346271085845e-007,2.55884432885586e-008,3.58264158632424e-010,1.54336629990176e-012],[0.000119388386298071,0.000394514014864284,0.000730119545110641,0.00075603812824123,0.000594596877756053,0.000576095694387173,0.000612520696933314,0.00063009677678842,0.00071353178468451,0.000901664362210161,0.00108904131456236,0.00116067235545517,0.00108309195230695,0.00110281228772781,0.00134765083714974,0.00148200502494615,0.00117997756340536,0.000650711637241332,0.000244352221429912,5.68092913731534e-005,8.1589101680933e-006,1.15995595637537e-006,1.21662903798854e-006,4.97083833601116e-006,7.51181137816139e-006,3.57254371758401e-006,5.26518688857116e-007,2.39322128732294e-008,3.34956228924366e-010,1.44841433657138e-012],[0.000103343323568884,0.000338451652411479,0.000638598245211762,0.000648999802958315,0.000473079913991988,0.000464820313655921,0.000514566805661614,0.000544904556671467,0.000647758780214579,0.000844357469538207,0.00107477383246416,0.00123612408049192,0.00118744546888867,0.00109416061111174,0.00114659733217104,0.00123637854941243,0.00113360892246793,0.000782690963298419,0.000364941674266313,0.000102851793547346,1.91530947243917e-005,3.89473410956028e-006,1.82475575011084e-006,3.96183867858025e-006,4.95831499812095e-006,2.19464316564771e-006,3.15250950777084e-007,1.42036483855649e-008,1.98404985706027e-010,1.22136843600443e-012],[7.4412947903109e-005,0.000252482331137009,0.000508560272858931,0.000538772451136805,0.000379220382744999,0.000355085877410662,0.000395207386024251,0.000437508911043188,0.000543517634967645,0.000714804743041384,0.000964598135828766,0.00121353304359359,0.00123393318018649,0.00108993129520043,0.00096609165671072,0.000928952886886589,0.000948724457948253,0.000816375129417645,0.000462019677710442,0.000155504650503686,3.79354558168127e-005,1.03760208778047e-005,4.00982093948961e-006,4.61765612739785e-006,3.44551542329771e-006,1.07660654052276e-006,1.30498822532086e-007,5.50090561486566e-009,8.32909453540666e-011,1.53840489618051e-011],[4.45383942098503e-005,0.000166859468341176,0.000379791656988536,0.000456402793568165,0.00035457252877122,0.000319848194387544,0.000339656017409062,0.000376919026697394,0.000471362590590355,0.00060783754302466,0.00083918298963368,0.00111409511235237,0.0011785491471683,0.00102579864101356,0.000834528974893824,0.000714106646435691,0.000755051530206813,0.000770171633653126,0.000517760714706153,0.000209054260122344,6.57685541299467e-005,2.11579670163044e-005,7.66423012526366e-006,7.18661196547896e-006,3.90107902718552e-006,7.5199534157493e-007,5.55402888537883e-008,1.71306176641997e-009,2.35349952486687e-010,3.89286290826958e-010],[2.24045354923177e-005,0.00010083269876894,0.000272296177855146,0.000393060044977423,0.000376174803917715,0.000364202732990415,0.000373228648579625,0.000390487060100134,0.000459749084172558,0.000558979423485962,0.000732737789152605,0.000961546860367925,0.00103103054651703,0.00089902364535593,0.000740500352691314,0.000613474294117107,0.000623756486317907,0.000706590594880143,0.000564960438857934,0.000275195933942465,0.000101400176393518,3.28388858436818e-005,1.03501032477665e-005,8.59631734479273e-006,4.36385622355339e-006,7.21762158299973e-007,3.86015161243348e-008,1.31464570003547e-009,3.5305635663395e-009,6.35596579300759e-009],[1.0081300196636e-005,5.89306053030367e-005,0.000190632154306538,0.000332054034233378,0.000401075624167468,0.000450414685774657,0.000472231855722011,0.000466433950607057,0.000495455727458416,0.000546855919953275,0.000646401352802967,0.000796650594758461,0.000851398734530976,0.000763038134189727,0.000679525344404864,0.000584761309054858,0.000554941397662767,0.000666346593043841,0.000637551765777407,0.000363987420718133,0.000137820360668288,3.95320032232809e-005,9.83948275657895e-006,6.73453510608011e-006,3.3404666689149e-006,5.39808385168152e-007,2.7398773410032e-008,6.63552049792661e-009,3.63920398049989e-008,6.56058581188291e-008],[4.76261050564018e-006,3.56264838839012e-005,0.000131516896587518,0.000268050070918341,0.000407192045983937,0.000547521155414738,0.000616480731997211,0.000598122603554864,0.000572759956770692,0.000563380084836927,0.000608122172901869,0.000701526544219637,0.000742548112139621,0.00069801182578019,0.000676476192976278,0.000613053143638,0.000540217295957048,0.000660623929719739,0.000738230775478725,0.000468974977029548,0.000169217110025374,4.01814752710749e-005,7.36104064388262e-006,3.45554534229011e-006,1.63642380692546e-006,2.63010452283629e-007,1.52041960500027e-008,4.07159840576059e-008,2.37414860018514e-007,4.28024056000109e-007],[3.10674009973522e-006,2.52152306259736e-005,9.52899431254981e-005,0.000213701333590956,0.000404756389884713,0.000648107523400037,0.000788799740328938,0.000771026357985642,0.000686705749937799,0.000613673882763324,0.000641496756627133,0.000728255532356523,0.000766547017656161,0.00074050137751552,0.000744878172290123,0.000697184481449311,0.000579887072253821,0.000696220127446265,0.000850961534251054,0.00057105980215196,0.000197262940125358,4.11929087350739e-005,6.23223564056868e-006,1.40664101577978e-006,5.19479704684399e-007,8.16118893447559e-008,1.28098036278256e-008,1.67135858872131e-007,9.79028630285364e-007,1.76505110831781e-006],[3.54761876323761e-006,2.51956759078944e-005,8.58373407904056e-005,0.000189959801540481,0.000410517126806249,0.000728996063662584,0.000923071247501504,0.000906904108049545,0.000780048107792405,0.000664064624053986,0.000698729362622624,0.000810592663112479,0.00085760213677819,0.000826145873276425,0.000827125608662639,0.000778867144505907,0.00062806408312114,0.00073307426556158,0.000915798742449189,0.000625646328335715,0.000216982236313924,4.70576105563131e-005,7.98505177499795e-006,1.00614996439833e-006,1.35321502777902e-007,1.68413813036427e-008,2.36558139524488e-008,4.35485663305968e-007,2.55180749240863e-006,4.60055175057898e-006],[5.38776995687664e-006,3.33708333714362e-005,0.000103842248651456,0.000209240696509837,0.000423780012967885,0.000743327788575302,0.000934031359176071,0.000912213911777849,0.000784162305718499,0.000673459381123805,0.000712740783329454,0.000837042605846795,0.000898480317554585,0.000865058597535605,0.000848712524907248,0.000780257591775371,0.000614667172102749,0.000703113665055612,0.000866744601643149,0.00059268165940201,0.000214357581272199,5.28517916170906e-005,1.07127801837422e-005,1.29811839644198e-006,7.37567149248045e-008,3.59407198958342e-009,3.77705121999063e-008,7.17428957994818e-007,4.20401310660534e-006,7.57924738126426e-006],[7.74834889020087e-006,4.73495116243325e-005,0.000147564927924835,0.000273152051941027,0.000449679222600943,0.000695069412419291,0.000829708656904015,0.000803014132049212,0.000721688704183281,0.000663371475378588,0.000698555418499531,0.000809853166000229,0.00088783846475024,0.00087155772336361,0.00082766717819438,0.000716247679800113,0.000552183019874348,0.000627171611889263,0.000747187804187113,0.000505919780668782,0.000191186677251019,5.12778949891059e-005,1.10821287151168e-005,1.36889703310671e-006,6.81046348476384e-008,1.91143861984283e-009,3.92372979304738e-008,7.47063912627066e-007,4.37767735074927e-006,7.89233972548859e-006],[1.05040763977933e-005,6.59193991138746e-005,0.000211357443412012,0.000370441619559661,0.000499589225032128,0.000638727343949193,0.000698798059473933,0.000679553546538465,0.00066665076934774,0.00067731323113564,0.000724966994514223,0.000831999129901173,0.000934410523629059,0.000946614050790152,0.000855913517471926,0.000680220954969706,0.000531589022713997,0.000609659846806983,0.000671992422626476,0.000434946467727412,0.000163403643156311,4.20286526628019e-005,8.29541279651685e-006,9.73312148671884e-007,4.71721929250795e-008,1.2207825479258e-009,2.58215928680705e-008,4.91700816811171e-007,2.88128995428939e-006,5.19456262906987e-006],[1.62149911322548e-005,9.14056118785924e-005,0.000285435812307486,0.000475621691910133,0.000554589630902506,0.000593436303953584,0.000594361411140156,0.000592394547815541,0.000632423004764308,0.000709483199644892,0.000824966624733031,0.000976174604874423,0.00111313456249077,0.00114566009780957,0.000979675673612943,0.000727438671255951,0.000619320083583523,0.000716164100649496,0.00068059379487386,0.000389781555374545,0.000133651702193603,2.94658921735775e-005,4.60801359954981e-006,4.65286692680113e-007,2.22412579926279e-008,7.69730980469791e-010,1.07607608335872e-008,2.04554296535342e-007,1.19865364012518e-006,2.1610047882531e-006],[2.96810878620915e-005,0.000131810689027412,0.000368991982759509,0.000573859144137278,0.000592278756982172,0.000551114506733523,0.000522785662139967,0.000537080201193169,0.000602603846853406,0.000744813990297059,0.000988980146022567,0.0012347402622295,0.00139831143059652,0.0014119144731302,0.00114759729061145,0.000845658600980289,0.000825067467136645,0.000922802617129841,0.000720867908920843,0.000337364775228256,9.68703577395663e-005,1.7331757733667e-005,2.00397242627713e-006,1.70260544661045e-007,1.96590287154929e-008,3.495592854111e-009,3.08216477221357e-009,5.37931665930655e-008,3.15183909165921e-007,5.68232406983486e-007],[5.42416644958135e-005,0.000198635792651157,0.000480920061053087,0.000682472431759638,0.00063345262691288,0.000534411476266249,0.000498792510039863,0.000526571795421863,0.000607111164311782,0.000810754596410673,0.00118969682204954,0.00152523920838546,0.00167394336593754,0.00161113598845563,0.00126853968189279,0.00101231611745009,0.00111356647553891,0.00113415122503739,0.000724443538441668,0.000268414181098335,6.02563995703701e-005,8.35611868076804e-006,7.54294161912318e-007,1.7881332701879e-007,1.15856103971477e-007,2.86647608891141e-008,2.67090527115714e-009,8.99153248950697e-009,5.23842720565955e-008,9.44408306489451e-008],[8.75955843017693e-005,0.000294581128097841,0.000636668537178415,0.000823782948684878,0.000714960205845844,0.00057921069544572,0.000540413784692331,0.000582906557135919,0.000685626387618729,0.000929840761056886,0.00137083320013165,0.00172003509179119,0.00179786327245695,0.00163973926441586,0.00132002628331914,0.00122551319197698,0.00138810540799686,0.00122255570785581,0.000648192822041407,0.000195705008514808,3.4136757845039e-005,3.52393559501e-006,4.95449450426187e-007,7.69760998616462e-007,6.19293262901774e-007,1.54688242732826e-007,1.19397419283672e-008,1.2202980477968e-009,5.50499010268013e-009,9.92104267204964e-009],[0.000121216573571805,0.000399897736991824,0.000812208359088795,0.000986992221588602,0.000841437007801885,0.000684134218661579,0.000630448188852868,0.000685861766606459,0.000814387983503527,0.00105291802911249,0.00144049358084364,0.00171807462792882,0.00171636729205386,0.00153391076301875,0.00137710120839274,0.00145232000096296,0.00150332066858371,0.00110760536689527,0.000494331339961347,0.000127956700138836,1.86939554665507e-005,1.58428524808964e-006,1.04533222666138e-006,2.60403660903845e-006,2.11364031377322e-006,5.2808014509397e-007,4.05959765131083e-008,1.02235698389701e-009,3.7237449752505e-010,6.58761599717071e-010],[0.000145331867409768,0.000479319707326756,0.000946802365173895,0.0011209130833131,0.000966675263568886,0.000789501556958218,0.000701210039861461,0.000756066741814847,0.00089569711987207,0.0010812110397466,0.00133361980174059,0.00151711894253926,0.00151285795016919,0.00143354514823004,0.00147911427228581,0.00156425329080553,0.00135896242488157,0.000827090446651961,0.000315280309754824,7.24278900670332e-005,9.52691493400426e-006,8.94064121392748e-007,2.14767152745873e-006,5.6164990360695e-006,4.56080575115239e-006,1.13949846976785e-006,8.75916542014827e-008,2.07412348230095e-009,3.04074207006751e-011,2.76803804530227e-011],[0.000155561327059321,0.000508164325707302,0.000985996679487523,0.0011599881109886,0.00101306053888878,0.000811775864698546,0.000677863072999796,0.000707312904320728,0.000831618304319903,0.000964090526228757,0.00109930931072085,0.00123763818109338,0.00132687422138748,0.00139439686554829,0.00150046668215824,0.00141272369967914,0.000998390414505635,0.000507580757723423,0.000170790546267066,3.59599268861344e-005,4.34371364984893e-006,6.01120418312902e-007,2.90902998690276e-006,7.65996387540431e-006,6.22041023679836e-006,1.55414435719463e-006,1.19464721305982e-007,2.82536521292089e-009,2.09639966061839e-011,7.7940133200774e-013],[0.000153332580206801,0.000490102816033295,0.000928871685065075,0.00108183176316275,0.000938372085157579,0.00071934828727027,0.000553985924015879,0.000544878733236399,0.000639610219989799,0.000763362980805775,0.000871406498932438,0.00102446471991797,0.00119815985813738,0.00129030474567255,0.0012723729889839,0.00100916788268972,0.00058479789648961,0.000257687865627599,8.10115330931197e-005,1.64365425750663e-005,1.8465038567481e-006,3.87709367998458e-007,2.50390663339501e-006,6.60336055739092e-006,5.36241168680549e-006,1.33977693459056e-006,1.02986619380715e-007,2.43559610804842e-009,1.77285165463983e-011,5.19682635805892e-014],[0.000142076361132391,0.000449427574572836,0.000829489497698965,0.000937254328947003,0.000784393729792786,0.000566573564165567,0.000401111909990828,0.000368876222963231,0.000442831282915816,0.000585373126412389,0.000717182233309955,0.000875054357756461,0.00101603109443977,0.000994769840653095,0.000833384963075715,0.00055085082404981,0.000268751229175967,0.000108301848408852,3.35053328752176e-005,6.73802601210996e-006,7.23255419689739e-007,1.91699048023826e-007,1.36375912053169e-006,3.59806442789051e-006,2.921896427595e-006,7.30024044547439e-007,5.61158402064718e-008,1.32711859912131e-009,9.65635449739907e-012,2.17468528752605e-014],[0.000125393250609173,0.000403196743805507,0.000731124305278493,0.000789828617537149,0.000626331967933325,0.000431252630469068,0.000290358611880284,0.000255267532796137,0.000316438213016316,0.000453773983253966,0.000574021084413466,0.000672428061105738,0.000705004300023035,0.000587554611182944,0.00040716064194129,0.000226021759050456,9.53754255654362e-005,3.68515054287503e-005,1.14302572893033e-005,2.22393447331336e-006,2.28639090623732e-007,6.43190158722417e-008,4.69628156561706e-007,1.23918718537054e-006,1.0063128331243e-006,2.51423205540122e-007,1.93265201764797e-008,4.57064958034288e-010,3.32566276362255e-012,7.44569493523362e-015],[0.000101637603199329,0.000334503606746602,0.000601601579992272,0.000625972237416609,0.000475677692426751,0.000324700008230758,0.000220135770725603,0.000187993205697476,0.000228883059058817,0.000319869490454138,0.000382183948812445,0.000401957691304597,0.000365883963959952,0.000255747212317046,0.000146800133238824,6.95171967155917e-005,2.57312221972304e-005,9.69394524443032e-006,2.99604934436887e-006,5.4045669408358e-007,5.1720944387515e-008,1.3983453110798e-008,1.02229248087121e-007,2.69754424360138e-007,2.19060831715513e-007,5.47314659417846e-008,4.20712471047606e-009,9.94969224329652e-011,7.23952158297068e-013,1.6206417814524e-015],[6.7619888449432e-005,0.000225068079817035,0.000402695818741571,0.000409382901021848,0.000304800039518586,0.000212611067982594,0.000148971263474366,0.00012292538539607,0.000139884361718081,0.000177051219640862,0.000189331059941549,0.000173218058361481,0.000135923265420494,8.04893166350265e-005,3.89679428443837e-005,1.61066338145665e-005,5.21485303129153e-006,1.87099832031552e-006,5.6923400940746e-007,9.27771141644221e-008,7.94689531103297e-009,1.94096913086187e-009,1.40660942681189e-008,3.71162265489361e-008,3.01411612477626e-008,7.53064766357117e-009,5.78869455187335e-010,1.3690045635674e-011,9.96104986495864e-014,2.2298790547609e-016]],"type":"surface","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
<p>Otra forma de verlo es usando la geometría <code>geom_raster()</code>. Esta se usó una vez en la publicación sobre <a href="https://www.johan-rosa.com/post/analisis-de-las-defunciones-en-republica-dominicana/">las defunciones en República Dominicana</a>.</p>
<p>En estos casos solo se grafican los jump shots porque incluir otros, como dunks, que fueron muchos y casi no los fallaba, le quita un poco de gracia a la visualización.</p>
<p>En general, Kobe no transformó considerablemente su selección de tiro a lo largo de su carrera.</p>
<pre class="r"><code>#c(&quot;1999-00&quot;, &quot;2000-01&quot;, &quot;2001-02&quot;, &quot;2008-09&quot;, &quot;2009-10&quot;)

shots_data %&gt;% 
  filter(combined_shot_type == &quot;Jump Shot&quot;,
         shot_zone_basic != &quot;Backcourt&quot;,
         season %in% c(&quot;2008-09&quot;, &quot;2009-10&quot;),
         !is.na(shot_made_flag))%&gt;%
  ggplot() +
  stat_density2d(
    aes(x = loc_x,
        y = loc_y,
        fill = stat(density/ max(density))),
    geom = &quot;raster&quot;,
    contour = FALSE,
    interpolate = TRUE,
    n = 50) +
  geom_path(
    data = court_points,
    aes(x = x, y = y, group = desc),
    color = &quot;white&quot;
  ) + 
  facet_wrap(~season) +
  scale_fill_viridis_c(
      &quot;Frecuencia&quot;,
      limits = c(0, 1),
      breaks = c(0, 0.5, 1),
      labels = c(&quot;baja&quot;, &quot;media&quot;, &quot;alta&quot;),
      option = &quot;magma&quot;,
      guide = guide_colorbar(barwidth = 10)
    )  +
  theme(
    axis.text = element_blank(),
    axis.title = element_blank(),
    panel.grid = element_blank(),
    axis.ticks = element_blank(),
    panel.background = element_blank(),
    strip.text = element_text(size = 12),
    legend.position = &quot;bottom&quot;
  ) + 
  labs(title = &quot;Heatmap de los tiros tomados en las temporadas 2009 y 2010&quot;) +
  coord_cartesian(expand = FALSE)</code></pre>
<p><img src="/post/2020-03-24-la-grandeza-de-kobe-bryant-ii-explorando-su-seleccion-de-tiros_files/figure-html/heat_map-1.png" width="672" /></p>
<p>Un gráfico más, ahora con los trableritos y los ganchos. En estos gráficos queda claro que tomaba los ganchos desde el centro y los tableritos del lado derecho, el lado de su mano dominante.</p>
<pre class="r"><code>shots_data %&gt;% 
  filter(combined_shot_type %in% c(&quot;Bank Shot&quot;, &quot;Hook Shot&quot;), shot_zone_basic != &quot;Backcourt&quot;) %&gt;% 
  mutate(
    combined_shot_type = factor(
      combined_shot_type,
      levels =  c(&quot;Bank Shot&quot;, &quot;Hook Shot&quot;),
      labels = c(&quot;Tableritos&quot;, &quot;Ganchos&quot;))
  ) %&gt;% 
  ggplot() +
        stat_density2d(
          aes(x = loc_x,
              y = loc_y,
              fill = stat(density/ max(density))),
          geom = &quot;raster&quot;,
          contour = FALSE,
          interpolate = TRUE,
          n = 50
          ) +
  facet_wrap(~combined_shot_type, scales = &quot;free&quot;) +
  geom_path(
    data = court_points,
    aes(x = x, y = y, group = desc),
    color = &quot;white&quot;
  )  +
  scale_fill_viridis_c(
      &quot;Frecuencia de tiro&quot;,
      limits = c(0, 1),
      breaks = c(0, 1),
      labels = c(&quot;baja&quot;, &quot;alta&quot;),
      option = &quot;magma&quot;,
      guide = guide_colorbar(barwidth = 8)
    )  +
  theme(
    axis.text = element_blank(),
    axis.title = element_blank(),
    panel.grid = element_blank(),
    axis.ticks = element_blank(),
    panel.background = element_blank(),
    strip.text = element_text(size = 12),
    legend.position = &quot;bottom&quot;
  ) + 
  coord_cartesian(expand = FALSE)</code></pre>
<p><img src="/post/2020-03-24-la-grandeza-de-kobe-bryant-ii-explorando-su-seleccion-de-tiros_files/figure-html/heat_map2-1.png" width="672" /></p>
<p>El tipo de tiro es una variable muy interesante y que sin dudas tendrán un protagonismo mayor a la hora de hacer el ejercicio de clasificación de los tiros para la competencia.</p>
<pre class="r"><code>shots_data %&gt;% 
  group_by(combined_shot_type) %&gt;% 
  summarise(
    cantidad = n(),
    eficiencia = mean(shot_made_flag, na.rm = TRUE)
  ) %&gt;% arrange(desc(cantidad))</code></pre>
<pre><code>## # A tibble: 6 x 3
##   combined_shot_type cantidad eficiencia
##   &lt;chr&gt;                 &lt;int&gt;      &lt;dbl&gt;
## 1 Jump Shot             23485      0.391
## 2 Layup                  5448      0.565
## 3 Dunk                   1286      0.928
## 4 Tip Shot                184      0.349
## 5 Hook Shot               153      0.535
## 6 Bank Shot               141      0.792</code></pre>
<p>Ahora unas cuantas visualizaciones de Kobe en el clutch. El siguiente gráfico analiza la cantidad de tiros que tomaba en cada minuto del último cuarto. No es de sorprender que al principio del último período tomara pocos tiros, porque normalmente a los estelares los descansan al principio para aprovecharlos al final del juego.</p>
<p>En el caso de Kobe, claramente, los últimos 6 minutos del último período eran para él, sobre todo el último minuto.</p>
<pre class="r"><code>shots_data %&gt;% 
  filter(period == 4) %&gt;%
  group_by(minutes_remaining) %&gt;% 
  summarise(
    tiros = n(),
    eficiencia = mean(shot_made_flag, na.rm = TRUE)
    ) %&gt;% 
  ggplot(aes(x = minutes_remaining, y = tiros)) +
  geom_point(size = 4, color = &quot;midnightblue&quot;) +
  geom_text(aes(label = paste0(round(eficiencia*100, 1), &quot;%&quot;),
                vjust = -1)) +
  scale_x_reverse(breaks = 11:0) +
  theme_minimal() +
  coord_cartesian(ylim = c(300, 1000)) +
  labs(x = &quot;Minutos restantes&quot;,
       y = &quot;Cantidad de tiros&quot;,
       title = &quot;Tiros tomados en cada minutos del último cuarto y eficiencia&quot;,
       subtitle = &quot;Nadie tiraba más que Kobe en el clutch&quot;)</code></pre>
<p><img src="/post/2020-03-24-la-grandeza-de-kobe-bryant-ii-explorando-su-seleccion-de-tiros_files/figure-html/shots_4th_quarter-1.png" width="672" /></p>
</div>
<div id="comentarios-finales" class="section level2">
<h2>Comentarios finales</h2>
<p>Con este básico análisis exploratorio se sientan las bases para modelar los tiros de Kobe y tratar de clasificar los 5,000 intentos que vienen con <code>shot_made_flag</code> missing. El próximo post de esta serie se enfocará en eso, entrenando dos modelos y comparando sus resultados.</p>
<p>Al ser la variable dependiente una variable categórica es probable que termine comparando desempeño de una regresión logística y el random forest para clasificación.</p>
<p>Como el Random Forest es una metología de machine learning poco explorada en la literatura nacional, ese post vendrá acompañado de una nota metológica.</p>
</div>
<div id="referencias" class="section level2">
<h2>Referencias</h2>
<ul>
<li><a href="https://toddwschneider.com/posts/ballr-interactive-nba-shot-charts-with-r-and-shiny/" class="uri">https://toddwschneider.com/posts/ballr-interactive-nba-shot-charts-with-r-and-shiny/</a></li>
<li><a href="https://www.kaggle.com/apapiu/exploring-kobe-s-shots" class="uri">https://www.kaggle.com/apapiu/exploring-kobe-s-shots</a></li>
<li><a href="https://www.r-graph-gallery.com/2d-density-chart.html" class="uri">https://www.r-graph-gallery.com/2d-density-chart.html</a></li>
<li><a href="https://www.kaggle.com/dansbecker/nba-shot-logs" class="uri">https://www.kaggle.com/dansbecker/nba-shot-logs</a></li>
<li><a href="https://github.com/toddwschneider/nba-shots-db" class="uri">https://github.com/toddwschneider/nba-shots-db</a></li>
</ul>
</div>


                

                <hr>
                <ul class="pager">
                    
                    <li class="previous">
                        <a href="/post/pir%C3%A1mides-de-poblaci%C3%B3n-con-ggplot2/" data-toggle="tooltip" data-placement="top" title="Pirámides de población con ggplot2">&larr;
                            Post anterior</a>
                    </li>
                    
                    
                    <li class="next">
                        <a href="/post/tensorflow-y-keras-con-r/" data-toggle="tooltip" data-placement="top" title="Tensorflow y keras con R">Próximo
                            post &rarr;</a>
                    </li>
                    
                </ul>

                <div id="disqus_thread"></div>
<script>
(function() {
var d = document, s = d.createElement('script');
s.src = 'https://johan-blog.disqus.com/embed.js';
s.setAttribute('data-timestamp', +new Date());
(d.head || d.body).appendChild(s);
})();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>

            </div>
            
            <div class="
                col-lg-11 col-lg-offset-1
                col-md-10 col-md-offset-1
                sidebar-container">

                
                
                

    <script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML"></script>
    
    <script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        tex2jax: {
            inlineMath: [ ['$','$'], ["\\(","\\)"] ],
            displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
            processEscapes: true,
            processEnvironments: true
        },
        // Center justify equations in code and markdown cells. Elsewhere
        // we use CSS to left justify single line equations in code cells.
        displayAlign: 'center',
        "HTML-CSS": {
            styles: {'.MathJax_Display': {"margin": 0}},
            linebreaks: { automatic: true }
        }
    });
    </script>
    

                
                
                <section>
                    <hr>
                    <h5>Colegas</h5>
                    <ul class="list-inline">
                        
                        <li><a target="_blank" href="http://betaeconomia.blogspot.com/">Nerys Ramírez</a></li>
                        
                    </ul>
                </section>
                
            </div>
        </div>
    </div>
</article>




<footer>
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <ul class="list-inline text-center">
                   
                    
                    <li>
                        <a href="mailto:johan.rosaperez@gmail.com">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-envelope fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
		    
                    
                    
                    
                    

                    

		    
                    
                    
                    <li>
                        <a target="_blank" href="https://github.com/johan-rosa">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-github fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
		    
                    
                    
                    
                    <li>
                        <a target="_blank" href="https://www.linkedin.com/in/johan-rosa-72bb0484/">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-linkedin fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
		    
                    
                    
                    <li>
                        <a target="_blank" href="https://stackoverflow.com/users/10266675/johan-rosa">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-stack-overflow fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
            
                    
                    
                    
            
                </ul>
		<p class="copyright text-muted">
                    Copyright &copy; Johan Rosa 2020
                    <br>
                    <a href="https://themes.gohugo.io/hugo-theme-cleanwhite">CleanWhite Hugo Theme</a> by <a href="https://zhaohuabing.com">Huabing</a> |
                    <iframe
                        style="margin-left: 2px; margin-bottom:-5px;"
                        frameborder="0" scrolling="0" width="100px" height="20px"
                        src="https://ghbtns.com/github-btn.html?user=zhaohuabing&repo=hugo-theme-cleanwhite&type=star&count=true" >
                    </iframe>
                </p>
            </div>
        </div>
    </div>
</footer>




<script>
    function async(u, c) {
      var d = document, t = 'script',
          o = d.createElement(t),
          s = d.getElementsByTagName(t)[0];
      o.src = u;
      if (c) { o.addEventListener('load', function (e) { c(null, e); }, false); }
      s.parentNode.insertBefore(o, s);
    }
</script>






<script>
    
    if($('#tag_cloud').length !== 0){
        async("/js/jquery.tagcloud.js",function(){
            $.fn.tagcloud.defaults = {
                
                color: {start: '#bbbbee', end: '#0085a1'},
            };
            $('#tag_cloud a').tagcloud();
        })
    }
</script>


<script>
    async("https://cdnjs.cloudflare.com/ajax/libs/fastclick/1.0.6/fastclick.js", function(){
        var $nav = document.querySelector("nav");
        if($nav) FastClick.attach($nav);
    })
</script>






<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
	ga('create', 'UA-151896571-1', 'auto');
	
	ga('send', 'pageview');
}
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>



</body>
</html>
